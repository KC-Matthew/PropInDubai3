<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Mon Profil - PropInDubai</title>
  <link rel="stylesheet" href="styles/accueil.css"/>
  <link rel="stylesheet" href="styles/profile.css"/>
  <script type="module" src="javascript/supabaseClient.js"></script>
  <script src="javascript/profile.js" defer></script>
</head>
<body>
  <!-- HEADER -->
  <div class="header2">
    <a href="accueil.html">
      <img class="logo" src="styles/photo/logo2.png" alt="PropInDubai Logo">
    </a>
  </div>

<main class="profile-container">
  <!-- Alerte (messages de succès/erreur) -->
  <div id="psAlert" style="display:none;"></div>

  <h1>My Account</h1>

  <!-- Onglets -->
  <div class="tabs">
    <button class="tab-btn active" data-tab="tab-info">My Profil</button>
    <button class="tab-btn" data-tab="tab-saved">Saved properties</button>
    <button class="tab-btn" data-tab="tab-subscription">Subscription</button>
    <button class="tab-btn" data-tab="tab-contacted">My listings</button>
  </div>

<!-- Onglet : Subscription -->
<section id="tab-subscription" class="tab-content" style="display:none;">
  <h2>Choose your subscription plan</h2>
  <div class="subscription-plans">

    <!-- Plan 1 -->
    <div class="plan-card" data-plan="basic">
      <h3>Monthly</h3>
      <ul class="plan-features">
        <li>Unlimited properties</li>
      </ul>
      <p class="price">2,000 AED / month</p>
      <button class="btn-orange subscribe-btn">Choose Monthly</button>
    </div>

    <!-- Plan 2 -->
    <div class="plan-card" data-plan="pro">
      <h3>3 Months</h3>
      <ul class="plan-features">
        <li>Unlimited properties</li>
        <li>Founder Badge / Pre-launching offer</li>
        <li>3 boosted properties per month</li>
        <li>Promotional video on social media</li>
        <li>Price locked for the future with Founder Badge</li>
      </ul>
      <p class="price">1,500 AED / month</p>
      <button class="btn-orange subscribe-btn">Choose 3 Months</button>
    </div>

    <!-- Plan 3 -->
    <div class="plan-card" data-plan="unlimited">
      <h3>6 Months</h3>
      <ul class="plan-features">
        <li>Unlimited properties</li>
        <li>Founder Badge / Pre-launching offer</li>
        <li>3 boosted properties per month</li>
        <li>Promotional video on social media</li>
        <li>Price locked for the future with Founder Badge</li>
      </ul>
      <p class="price">1,000 AED / month</p>
      <button class="btn-orange subscribe-btn">Choose 6 Months</button>
    </div>

  </div>
  <div id="current-subscription" class="current-sub-box"></div>
</section>

  <!-- Onglet : My Profil (Agent + Agency + Uploads) -->
  <section id="tab-info" class="tab-content active">
    <h2>Information</h2>

    <!-- Agent -->
    <form id="profileForm">
      <!-- Photo de profil (optionnelle) -->
    <!-- NOUVEAU (à coller) -->
<div class="pic-row" style="display:flex;gap:16px;align-items:center;margin-bottom:12px;flex-wrap:wrap;">
  <div class="pic">
    <img id="avatarPreview" alt="Profile picture preview">
    <div class="pic-blank">PP</div>
  </div>
  <div class="pic-actions">
    <div class="pi-label">Profile picture</div>

    <div class="pi-file">
      <!-- on garde ton ID existant -->
      <input id="fileProfilePicture" type="file" accept="image/*">
      <label for="fileProfilePicture" class="pi-file-btn">Choose an image</label>
      <span class="pi-file-hint">JPG/PNG/WebP, jusqu’à 5 MB.</span>
    </div>
  </div>
</div>



      <div class="grid-two" style="display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:12px;">
        <label>Name
          <input type="text" id="firstName" placeholder="First name"/>
        </label>
        <label>Surname
          <input type="text" id="lastName" placeholder="Last name"/>
        </label>
      </div>

      <h2>Contact</h2>
      <div class="grid-two" style="display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:12px;">
        <label>Email
          <input type="email" id="email" disabled/>
        </label>
        <label>Phone
          <input type="text" id="phone" placeholder="+971 ..."/>
        </label>
        <label>WhatsApp
          <input type="text" id="whatsapp" placeholder="+971 ..."/>
        </label>
        <label>Nationality
          <input type="text" id="nationality" placeholder="French"/>
        </label>
        <label>Languages
          <input type="text" id="languages" placeholder="English, French, Arabic"/>
        </label>
      </div>

      <label>About you
        <textarea id="about" rows="3" placeholder="A short bio to introduce yourself."></textarea>
      </label>

      <hr style="margin:20px 0; border:none; border-top:1px solid #eee;"/>

      <!-- Agency -->
      <h2>Agency</h2>

      <!-- Logo (optionnel) -->
    <div class="agency-logo" style="display:flex;gap:16px;align-items:center;margin-bottom:12px;flex-wrap:wrap;">
  <div style="width:140px;height:88px;border-radius:14px;overflow:hidden;background:#fafafa;border:1px solid #eee;display:flex;align-items:center;justify-content:center;">
    <img id="logoPreview" alt="Agency logo preview" style="max-width:100%;max-height:100%;display:none;object-fit:contain;">
  </div>

  <div>
    <label class="label" style="font-weight:700;">Agency logo</label><br/>

    <!-- keep the same ID; hide the native control -->
    <input id="fileAgencyLogo" type="file" accept="image/*" hidden>

    <!-- visible English button that triggers the hidden input -->
    <button type="button" id="chooseLogoBtn" class="btn-orange">Choose a logo</button>

    <!-- English hint -->
    <small style="display:block;color:#777;">SVG/PNG/JPG/WebP, up to 3 MB.</small>
  </div>
</div>


      <div class="grid-two" style="display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:12px;">
        <label>Agency name
          <input type="text" id="agc_name" placeholder="Your agency name"/>
        </label>
        <label>Address
          <input type="text" id="agc_address" placeholder="Address"/>
        </label>
      </div>

      <label>About the agency
        <textarea id="agc_about" rows="3" placeholder="Short description of your agency."></textarea>
      </label>

      <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:16px;">
        <button type="submit" class="save-btn btn-orange">Save</button>
      </div>
    </form>

  
  </section>


  <!-- Onglet : Saved properties -->
<section id="tab-saved" class="tab-content" style="display:none;">
  <p>No properties saved yet.</p>
</section>

<!-- Onglet : My listing -->
<section id="tab-contacted" class="tab-content" style="display:none;">
  <h2>My listing</h2>

  <!-- Paywall si l'agent n'a pas payé -->
  <div id="listingPaywall" class="notice" style="display:none;">
    <p>Your plan doesn’t allow creating/viewing listings.</p>
    <a href="#" class="btn-orange" data-open-tab="tab-subscription">Go to Subscription</a>
  </div>

  <!-- Sous-onglets (affichés seulement si paid=true) -->
<div class="tabs small" id="listingSubTabs">
  <button class="tab-btn active" data-subtab="sub-add">Add a listing</button>
  <button class="tab-btn" data-subtab="sub-view">View my listings</button>
</div>

<div id="sub-add" class="subtab active">



    <form id="addListingForm">
      <div class="grid-two" style="display:grid;grid-template-columns:repeat(2,1fr);gap:12px;">
        <label>Category
          <select id="lst_category" required>
            <option value="buy">Buy</option>
            <option value="rent">Rent</option>
            <option value="commercial">Commercial</option>
          </select>
        </label>
        <label>Property type
          <select id="lst_property_type" required>
            <option>Apartment</option>
            <option>Villa</option>
            <option>Townhouse</option>
            <option>Office</option>
            <option>Retail</option>
            <option>Warehouse</option>
          </select>
        </label>
        <label>Title
          <input id="lst_title" required placeholder="e.g. Apartment in JVC">
        </label>
        <label>Price (AED)
          <input id="lst_price" type="number" min="0" required>
        </label>
      <label>Bedrooms
  <select id="lst_bedrooms" required>
    <option value="0">0</option>
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4+</option>
  
  </select>
</label>

<label>Bathrooms
  <select id="lst_bathrooms" required>
    <option value="0">0</option>
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4+</option>

  
  </select>
</label>

        <label>Size (sqft)
          <input id="lst_sqft" type="number" min="0">
        </label>
        <label id="wrap_rental_period" style="display:none;">Rental period
          <select id="lst_rental_period">
            <option>Yearly</option>
            <option>Monthly</option>
          </select>
        </label>
        <label>Location
          <input id="lst_location" placeholder="Jumeirah Village Circle">
        </label>
      <!-- Properties pictures (remplace "Cover photo URL") -->
<div class="photos-block">
  <div class="photos-head">
    <label>Properties pictures</label>
    <div class="photos-actions">
      <!-- input natif (caché) -->
      <input id="lst_photos" type="file" accept="image/*" multiple hidden>
      <!-- bouton stylé qui ouvre l’input -->
      <button type="button" id="btnPickPhotos" class="btn-orange">Upload pictures</button>
      <small class="hint">JPG/PNG/WebP, jusqu’à 8 MB par image.</small>
    </div>
  </div>


  <!-- Grille d’aperçus -->
  <div id="lst_gallery" class="photos-grid"></div>


<!-- Live preview of the listing -->
<div id="listingPreview" class="listing-card" style="margin-top:20px;"></div>


  <!-- ID technique: la valeur sera un JSON d’URLs à sauver en DB -->
  <input type="hidden" id="lst_photos_json">
</div>

      </div>

      <label>Description
        <textarea id="lst_description" rows="3"></textarea>
      </label>



<!-- ===== More Filters (facultatifs) ===== -->
<div class="more-filters">
  <label class="chk-line">
    <input type="checkbox" id="lst_furnished"> Furnished  
  </label>

  <div class="mf-group">
    <div class="mf-title">Amenities</div>
    <div class="mf-grid">
      <!-- une case = data-amenity="..." -->
      <label class="chk"><input type="checkbox" class="amenity" data-amenity="Central A/C"> Central A/C</label>
      <label class="chk"><input type="checkbox" class="amenity" data-amenity="Maids Room"> Maids Room</label>
      <label class="chk"><input type="checkbox" class="amenity" data-amenity="Balcony"> Balcony</label>
      <label class="chk"><input type="checkbox" class="amenity" data-amenity="Shared Pool"> Shared Pool</label>
      <label class="chk"><input type="checkbox" class="amenity" data-amenity="Shared Gym"> Shared Gym</label>
      <label class="chk"><input type="checkbox" class="amenity" data-amenity="Concierge Service"> Concierge Service</label>
      <label class="chk"><input type="checkbox" class="amenity" data-amenity="Covered Parking"> Covered Parking</label>
      <label class="chk"><input type="checkbox" class="amenity" data-amenity="View of Water"> View of Water</label>
      <label class="chk"><input type="checkbox" class="amenity" data-amenity="View of Landmark"> View of Landmark</label>
      <label class="chk"><input type="checkbox" class="amenity" data-amenity="Private Garden"> Private Garden</label>
      <label class="chk"><input type="checkbox" class="amenity" data-amenity="Pets Allowed"> Pets Allowed</label>
      <label class="chk"><input type="checkbox" class="amenity" data-amenity="Private Pool"> Private Pool</label>
      <label class="chk"><input type="checkbox" class="amenity" data-amenity="Built in Wardrobes"> Built in Wardrobes</label>
      <label class="chk"><input type="checkbox" class="amenity" data-amenity="Built in Kitchen Appliances"> Built in Kitchen Appliances</label>
      <label class="chk"><input type="checkbox" class="amenity" data-amenity="Barbecue Area"> Barbecue Area</label>
    </div>
  </div>

  <div class="grid-two" style="margin-top:8px;">
    <label>Keywords
      <input id="lst_keywords" placeholder="e.g. pool, chiller free">
    </label>
  </div>
</div>
<!-- ===== fin More Filters ===== -->






      <div style="display:flex;gap:10px;justify-content:flex-end">
        <button type="submit" class="btn-orange">Save listing</button>
      </div>
    </form>
    <div id="addListingAlert" class="notice" style="display:none;margin-top:10px;"></div>
  </div>

  <!-- SUBTAB: View my listings -->
  <div id="sub-view" class="subtab">
    <div id="myListings"></div>
    <div id="viewListingAlert" class="notice" style="display:none;margin-top:10px;"></div>
  </div>
</section>


</main>


<script src="https://cdn.jsdelivr.net/npm/heic2any/dist/heic2any.min.js"></script>
